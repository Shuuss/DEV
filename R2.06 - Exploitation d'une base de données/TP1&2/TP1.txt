--1

select titre, budget, 'Film Ã  gros budget' as "Type" from film
where budget >= 100000000;

--2

select ville from personne
group by ville
order by ville;

--3

select * from personne
where rue like '%Avenue%';

--4

select numpersonne,nom,prenom,telephone from personne
where telephone is null;

--5

select nom,prenom,nationalite from personne
where nationalite != 'Francais' and nationalite != 'Anglais' and nationalite != 'Americain';

--6

select titre, libellegenre, nom, prenom from film f join personne p
on p.numpersonne = f.realisateur join genre g
on g.numgenre = f.genre
where nom = 'Tarentino';

--7

select nom, prenom from personne p join acteur a
on p.numpersonne = a.numpersonne
order by nom;

--8

select nom, prenom, ville from personne p join film f
on f.realisateur = p.numpersonne
where ville like 'L%'
order by nom;

--9

select titre from film f join programmation p
on p.numfilm = f.numfilm join cinema c
on c.numcinema = p.numcinema
where nomcinema = 'UGC';

--10

select distinct prenom, nom from film f join distribution d
on d.numfilm = f.numfilm join acteur a
on a.numacteur = d.numacteur join personne p
on p.numpersonne = a.numpersonne
where d.salaire > f.Salaire_real;

--11

select p1.prenom, p1.nom from personne p1 join acteur a
on a.numpersonne = p1.numpersonne join genre g
on g.numgenre = a.specialite join distribution d
on d.numacteur = a.numacteur join film f
on f.numfilm = d.numfilm join personne p2
on p2.numpersonne = f.realisateur
where Libellegenre = 'Comedie' and p2.nom = 'Hazanavicius';

--12

select distinct p1.prenom, p1.nom from personne p1 join film f
on f.realisateur = p1.numpersonne join distribution d
on d.numfilm = f.numfilm join acteur a
on a.numacteur = d.numacteur join personne p2
on p2.numpersonne = a.numpersonne
where p1.numpersonne = p2.numpersonne;

--13

select libellegenre, count(numfilm) from genre g
join film f on f.genre = g.numgenre
where annee between 2012 and 2021
group by libellegenre;

--14

select SUM(salaire)"Montant des salaires" from film f
join distribution d on d.numfilm = f.numfilm
where titre = 'Intouchables';

--15

select libellegenre, avg(budget)"Budget Moyen" from genre g
join film f on f.genre = g.numgenre
where annee between 2012 and 2021
group by libellegenre
having avg(budget) >= 100000000
order by libellegenre;

--16

select titre, annee, longueur from film
where longueur = (select max(longueur) from film); 

select titre, annee, longueur from film
where longueur >= all(select longueur from film);

--17

select titre from film f
join programmation p on p.numfilm = f.numfilm
join salle s on s.numsalle = p.numsalle and s.numcinema = p.numcinema
where taille_ecran = (select max(Taille_ecran) from salle);

--18

select nom,prenom from personne
where numpersonne not in (select p.numpersonne from personne p
						 join acteur a on p.numpersonne = a.numpersonne);

select nom, prenom from personne p
left join acteur a on a.numpersonne = p.numpersonne
where numacteur is null;

--19

select nom, prenom from personne p
left join acteur a on a.numpersonne = p.numpersonne
left join film f on f.realisateur = p.numpersonne
where numacteur is null and realisateur is null;

select nom,prenom from personne
where numpersonne not in (select p.numpersonne from personne p
						 join acteur a on p.numpersonne = a.numpersonne)
	  and numpersonne not in(select p1.numpersonne from personne p1
							join film f on f.realisateur = p1.numpersonne);

--20

select nom, prenom, sum(salaire)"Salaire total" from personne p
join acteur a on a.numpersonne = p.numpersonne
join distribution d on d.numacteur = a.numacteur
group by nom,prenom
having sum(salaire) > all(select sum(salaire_real) from film f
						 join personne p2 on f.realisateur = p2.numpersonne
						 group by numpersonne);

--21

select libellegenre,titre from genre g
left join film f on f.genre = g.numgenre
order by libellegenre;

--22

select nomcinema from salle s
right join cinema c on c.numcinema = s.numcinema
where numsalle is null;

select nomcinema from cinema
where nomcinema not in (select nomcinema from salle s
						join cinema c on c.numcinema = s.numcinema);
						
--23

select titre from film f
left join programmation p on p.numfilm = f.numfilm
left join cinema c on c.numcinema = p.numcinema
where compagnie is null or compagnie != 'indep';

--24
select nom, prenom, anneenaiss from acteur a
join personne p on a.numpersonne = p.numpersonne
where anneenaiss in (select max(anneenaiss) from personne);

--25
select nom, prenom from acteur a
join personne p on a.numpersonne = p.numpersonne
where rue in (select rue from cinema) and ville in (select ville from cinema);

--26
select nomcinema,s.numsalle,titre from film f
left join programmation p on f.numfilm = p.numfilm
right join salle s on s.numcinema = p.numcinema and s.numsalle = p.numsalle
right join cinema c on s.numcinema = c.numcinema;
