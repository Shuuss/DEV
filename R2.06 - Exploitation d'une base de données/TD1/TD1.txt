--1
select employeid, nom, prenom from employe
where superieurhierarchique is null;

--2
select distinct nomsociete from client cl join commande co
on cl.clientid = co.clientid join lignescommande lc
on lc.commandeid = co.commandeid join produit p
on lc.produitid = p.produitid join fournisseur f
on f.fournisseurid = p.fournisseurid
where nomfournisseur = 'Exotic Liquids';

--3
select p.nom, p.prenom, p.fonction, p1.nom, p1.prenom, p1.fonction from employe p join employe p1
on p.superieurhierarchique = p1.employeid;

--4
select nomcategorie, nomproduit from categorie c left join produit p
on p.categorieid = c.categorieid
order by nomcategorie, nomproduit;

--5
select Count(horscatalogue)"nombre de produits hors catalogue" from produit
where horscatalogue = 'true';

--6
select nomcategorie, round(avg(prixunitaire)) from categorie c left join produit p
on p.categorieid = c.categorieid
group by nomcategorie
order by nomcategorie;

--7
select nomproduit from produit p
where p.produitid not in (select produitid from lignescommande);

select nomproduit from produit p left join lignescommande lc
on p.produitid = lc.produitid
where quantite is null;

select nomproduit from produit
except
select nomproduit from produit p join lignescommande lc
on p.produitid = lc.produitid;

--8
select nom, prenom, datenaissance from employe
where employeid not in (select employeid from commande);

select nom, prenom, datenaissance from employe e left join commande c
on e.employeid = c.employeid
where commandeid is null;

select nom, prenom, datenaissance from employe
except
select nom, prenom, datenaissance from employe e join commande c
on e.employeid = c.employeid;

--9
select nom, prenom, datenaissance,ville from employe
where datenaissance < any(select datenaissance from employe
						 where Ville = 'London');
						 
select nom, prenom, datenaissance,ville from employe
where datenaissance < all(select datenaissance from employe
						 where Ville = 'London');

select nom, prenom, datenaissance,ville from employe
where datenaissance < (select min(datenaissance) from employe
						 where Ville = 'London');
						 
--10
select nom,prenom from employe
where fonction = (select fonction from employe
				 where nom =  'Dodsworth' and prenom = 'Anne');
				 
--11
select c.commandeid, (sum(prixunitaire*quantite*(1-remise)) + fraisports)"montant" from commande c join lignescommande lc
on c.commandeid = lc.commandeid
group by c.commandeid
order by montant desc
limit 1;