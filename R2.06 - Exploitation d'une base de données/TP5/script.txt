alter table Q1a
add numitineraire integer not null;

INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (200,2,'2023-01-01',124);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (201,2,'2023-01-02',162);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (202,3,'2023-01-03',123);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (203,2,'2023-01-04',172);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (204,1,'2023-01-05',121);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (205,3,'2023-01-06',130);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (206,2,'2023-01-07',139);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (207,2,'2023-01-08',156);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (208,2,'2023-01-09',169);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (209,1,'2023-01-10',179);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (210,1,'2023-01-11',127);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (211,2,'2023-01-12',134);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (212,1,'2023-01-13',140);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (213,3,'2023-01-14',159);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (214,2,'2023-01-15',106);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (215,1,'2023-01-16',170);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (216,3,'2023-01-17',176);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (217,1,'2023-01-18',128);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (218,2,'2023-01-19',121);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (219,2,'2023-01-20',166);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (220,3,'2023-01-21',138);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (221,2,'2023-01-22',177);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (222,2,'2023-01-23',133);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (223,2,'2023-01-24',166);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (224,2,'2023-01-25',131);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (225,3,'2023-01-26',137);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (226,2,'2023-01-27',164);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (227,2,'2023-01-28',167);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (228,2,'2023-01-29',119);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (229,1,'2023-01-30',134);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (230,1,'2023-01-31',175);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (231,1,'2023-02-01',155);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (232,2,'2023-02-02',131);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (233,2,'2023-02-03',112);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (234,3,'2023-02-04',109);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (235,1,'2023-02-05',107);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (236,2,'2023-02-06',106);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (237,2,'2023-02-07',157);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (238,3,'2023-02-08',129);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (239,2,'2023-02-09',109);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (240,1,'2023-02-10',117);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (241,1,'2023-02-11',151);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (242,2,'2023-02-12',156);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (243,2,'2023-02-13',112);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (244,2,'2023-02-14',102);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (245,2,'2023-02-15',100);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (246,2,'2023-02-16',171);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (247,2,'2023-02-17',166);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (248,1,'2023-02-18',150);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (249,1,'2023-02-19',152);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (250,3,'2023-02-20',106);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (251,2,'2023-02-21',118);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (252,1,'2023-02-22',173);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (253,2,'2023-02-23',104);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (254,2,'2023-02-24',130);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (255,2,'2023-02-25',143);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (256,2,'2023-02-26',126);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (257,2,'2023-02-27',164);
INSERT INTO Q1a(numsortie,idmeteo,datesortie,numitineraire) VALUES (258,2,'2023-02-28',179);

SELECT numsortie, datesortie, idmeteo, 191
FROM Q1a
WHERE numsortie=211;
INSERT INTO Q1a (numsortie, datesortie, idmeteo, numitineraire)
SELECT numsortie, datesortie, idmeteo, 192
FROM Q1a
WHERE numsortie=221;
INSERT INTO Q1a (numsortie, datesortie, idmeteo, numitineraire)
SELECT numsortie, datesortie, idmeteo, 193
FROM Q1a
WHERE numsortie=231;
INSERT INTO Q1a (numsortie, datesortie, idmeteo, numitineraire)
SELECT numsortie, datesortie, idmeteo, 194
FROM Q1a
WHERE numsortie=241;
INSERT INTO Q1a (numsortie, datesortie, idmeteo, numitineraire)
SELECT numsortie, datesortie, idmeteo, 195
FROM Q1a
WHERE numsortie=251;

create table Q1b
as SELECT numsortie,datesortie,idmeteo,i.numitineraire,tempsth,
CASE q.idmeteo
WHEN 1 THEN round((i.tempsth*floor((random() * (90-80+1)) +
80)/100)::numeric, -1)
WHEN 2 THEN round((i.tempsth*floor((random() * (110-90+1)) +
90)/100)::numeric, -1)
WHEN 3 THEN round((i.tempsth*floor((random() * (130-110+1)) +
110)/100)::numeric, -1)
END AS dureeitineraire
FROM Q1a q
JOIN itineraire i ON q.numitineraire = i.numitineraire
ORDER BY numsortie;
insert into itinerairesortie(numsortie,numitineraire,dureeitineraire)
select numsortie,numitineraire,dureeitineraire from Q1b;

