CREATE OR REPLACE PROCEDURE generation_participations(pNumSortieMin integer, pNumSortieMax integer, 
													  pNumClientMin integer, pNumClientMax integer)			
LANGUAGE plpgsql
AS $$
DECLARE
	i integer;
	j integer;
	vNumClientDebut integer;
	vNbclients integer;
BEGIN
	FOR i IN pNumSortieMin .. pNumSortieMax LOOP
		vNumClientDebut := floor((random() * (pNumClientMax-pNumClientMin+1)) + pNumClientMin)::int;
		IF vNumClientDebut > pNumClientMax-10 THEN 
			vNumClientDebut := pNumClientMax-10;
		END IF;
		vNbclients := floor(random() * 10 + 1)::int;
		FOR j IN 1 .. vNbclients LOOP
			INSERT INTO participation (numsortie, numclient)
				VALUES (i, vNumClientDebut+j);
		END LOOP;
	END LOOP;
END;
$$;

CALL generation_participations(200, 258, 1301, 1499);

